readMe
Mapping EPA WQX 3.0 profiles for creating .csv outputs
Lee F. Stanish
2022-05-07

Files and descriptions (UPDATED 7/11/2022)
* Teams directory for all files: Teams/GS-W-OCOO-IOW/General/Files/IoW Team/Projects/WQP_NEMI/WQP/WQP Data Profiles/
* Teams link - https://teams.microsoft.com/_#/files/General?groupId=3de777cb-9805-4af6-bc52-2b76e61defa2&threadId=19%3A5e685c105f234374937c119669a8c294%40thread.skype&ctx=channel&context=WQP%2520Data%2520Profiles&rootfolder=%252Fsites%252Fgs-w-ocoo-iow%252FShared%2520Documents%252FGeneral%252FIoW%2520Team%252FProjects%252FWQP_NEMI%252FWQP%252FWQP%2520Data%2520Profiles
* Sharepoint link - https://doimspp.sharepoint.com/sites/gs-w-ocoo-iow/Shared%20Documents/General/IoW%20Team/Projects/WQP_NEMI/WQP/WQP%20Data%20Profiles
* GitHub directory for all files: 

Source Files
A) Raw input files. These are the final, approved versions of the Profile .csv names (non-standardized) and field orders from the EPA, with some iteration to fix errors, etc. These files should only be modified after conferring with EPA
about potential errors or when EPA requests an update to a Profile mapping. These files are also source files to the R script 'map_WQX3.0_csv_profiles.R'.
	1) Final_ActivityMetric_Profile_2022_04_01.xlsx
	2) Final_BasicBiological_Profile_2022_3_23.xlsx
	3) Final_BasicPhysicalChemical_Profile_2022_3_23_w_Allowable_Values.xlsx
	4) Final_BiologicalHabitatIndex_Profile_2022_04_01.xlsx
	5) Final_FullBiological_Profile_EPAconsensusReceived_2022_05_05.xlsx
	6) Final_FullPhysicalChemical_Profile_EPAconsensusReceived_2022_05_05.xlsx
	7) Final_ResultDetectionQuantitationLimit_Profile_2022_04_01.xlsx
	8) Final_SamplingActivity_Profile_2022_3_23_w_Allowable_Values.xlsx
	9) Final_Site_profile_rev2022_05_04.xlsx
	10) Final_Organization_Profile_EPAconsensusReceived2022_04_28.xlsx
	
B) WQX3.0_csv_fieldNames_andOrder_ResultsAndActivityProfiles.csv - manually curated file containing the Schema sort order, Data Element XML tag, EPA-provided (non-standardized) .csv field name,
delivery order, row order (including XML schema header values) header/field designation, and comments. This is a source file used to map the EPA provided data to the .csv output data sets for the following Profiles:
	1) ResultDetectionQuantitationLimit
	2) ActivityMetric
	3) BasicBiological
	4) FullBiological
	5) BasicPhysicalChemical
	6) FullPhysicalChemical
	7) BiologicalHabitatIndex
	8) SamplingActivity
	
C) WQX3.0_csv_fieldNames_andOrder_SiteProfile.csv - manually curated file containing the Schema sort order, Data Element XML tag, EPA-provided (non-standardized) .csv field name,
delivery order, row order (including XML schema header values) header/field designation, and comments. This is a source file used to map the EPA provided data to the .csv output data sets for the following Profiles:
	1) Site
	
D) WQX3.0_csv_fieldNames_andOrder_OrganizationProfile.csv - manually curated file containing the Schema sort order, Data Element XML tag, EPA-provided (non-standardized) .csv field name,
delivery order, row order (including XML schema header values) header/field designation, and comments. This is a source file used to map the EPA provided data to the .csv output data sets for the following Profiles:
	1) Organization

E) WQX_DET_v3.0.csv - Data Exchange template for the WQX 3.0 schema. Includes schema tags, definitions, rules, etc.

F) WQX3.0_mapping_final_20220404.csv - This is an EPA-provided file that maps the EPA WQX tables and fields to the XML schema tags.

Code File
G) map_WQX3.0_csv_profiles.R -  R script that takes in the EPA Profile lists, WQX3.0 Det, and EPA WQX mapping files and, for the most part, automatically maps input fields and output .csv field names. Note however that there
is some manual editing to deal with inconsistencies in schema order, a subset of many-to-one fields, custom field names, etc. Note also that the .csv field names to use are in the column named 'csvFieldNameStandardized' and
are not the same as those provided by the EPA, which do not conform to standard values.

Output Files
H) WQX3.0_csv_final_mapping_template_ResultsAndActivityProfiles.csv - scripted output generated by the R script 'map_WQX3.0_csv_profiles.R', SECTION 1. DO NOT EDIT THIS FILE. If updates are needed, go to the source files and re-run the script to generate a 
new version of this file. This file is designed for use by the developers to map the WQX EPA dump files to the proper Table and Field for the Results and Activity Profiles. Note that the developers still need to map this file to the internal USGS database mappings.

I) WQX3.0_csv_final_mapping_template_SiteProfile.csv - scripted output generated by the R script 'map_WQX3.0_csv_profiles.R', SECTION 2. DO NOT EDIT THIS FILE. If updates are needed, go to the source files and re-run the script to generate a 
new version of this file. This file is designed for use by the developers to map the WQX EPA dump files to the proper Table and Field for the Site Profile. Note that the developers still need to map this file to the internal USGS database mappings.

J) WQX3.0_csv_final_mapping_template_OrganizationProfile.csv - scripted output generated by the R script 'map_WQX3.0_csv_profiles.R', SECTION 3. DO NOT EDIT THIS FILE. If updates are needed, go to the source files and re-run the script to generate a 
new version of this file. This file is designed for use by the developers to map the WQX EPA dump files to the proper Table and Field for the Organization Profile. Note that the developers still need to map this file to the internal USGS database mappings.

	